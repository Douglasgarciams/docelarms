{% extends 'base.html' %}

{% block title %}Meus Imóveis - DOCELARMS{% endblock %}

{% block content %}
<div class="container my-5">
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h1 class="fw-bold">Meus Imóveis Anunciados</h1>
        <a href="{% url 'anunciar_imovel' %}" class="btn btn-primary btn-lg">
            <i class="bi bi-plus-circle me-2"></i>Anunciar Novo Imóvel
        </a>
    </div>

    <div class="card border-0 shadow-sm">
        <div class="card-body">
            <div class="table-responsive">
                <table class="table table-hover align-middle">
                    <thead>
                        <tr>
                            <th scope="col">Foto</th>
                            <th scope="col">Título</th>
                            <th scope="col">Preço</th>
                            <th scope="col">Cidade</th>
                            <th scope="col">Status</th> <th scope="col">Ações</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for imovel in imoveis %}
                        <tr>
                            <td>
                                {% if imovel.foto_principal %}
                                    <img src="{{ imovel.foto_principal.url }}" alt="{{ imovel.titulo }}" style="width: 100px; height: 60px; object-fit: cover; border-radius: 5px;">
                                {% else %}
                                    <div style="width: 100px; height: 60px; background-color: #eee; border-radius: 5px;"></div>
                                {% endif %}
                            </td>
                            <td>{{ imovel.titulo }}</td>
                            <td>R$ {{ imovel.preco|floatformat:2 }}</td>
                            <td>{{ imovel.cidade.nome }}</td>
                            
                            <td>
                                {% if imovel.status_publicacao == 'ATIVO' %}
                                    <span class="badge bg-success">{{ imovel.get_status_publicacao_display }}</span>
                                
                                {% elif imovel.status_publicacao == 'PEND_PAG' or imovel.status_publicacao == 'PEND_APROV' %}
                                    <span class="badge bg-warning text-dark">{{ imovel.get_status_publicacao_display }}</span>
                                
                                {% elif imovel.status_publicacao == 'REJEITADO' %}
                                    <span class="badge bg-danger">{{ imovel.get_status_publicacao_display }}</span>
                                
                                {% elif imovel.status_publicacao == 'EXPIRADO' %}
                                    <span class="badge bg-info text-dark">{{ imovel.get_status_publicacao_display }}</span>
                                
                                {% else %}
                                    <span class="badge bg-secondary">{{ imovel.get_status_publicacao_display }}</span>
                                {% endif %}
                            </td>
                            <td>
                                <a href="{% url 'editar_imovel' imovel.id %}" class="btn btn-sm btn-outline-primary">Editar</a>
                                <a href="{% url 'excluir_imovel' imovel.id %}" class="btn btn-sm btn-outline-danger">Excluir</a>
                            </td>
                        </tr>
                        {% empty %}
                        <tr>
                            <td colspan="6" class="text-center py-4">
                                Você ainda não tem nenhum imóvel anunciado.
                            </td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>
{% endblock %}